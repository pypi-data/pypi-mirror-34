<!DOCTYPE html>
<html>

<head>

<title>Oops, something went wrong.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="We are trying to keep things working here, but someone keeps throwing a monkey wrench in the works." />
<meta name="keywords" content="awesome 500 error page" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>

html, body {
    background-color: #286ca8;
    color: white;
    margin: 0;
    padding: 0;
    font-family: Helvetica; sans-serif;
}

#gears {
    position: absolute;
    height: 46vh;
    opacity: 1;
    left: 400px;
    right: 0;
    bottom: 0;
    padding: 0;
    margin: 0;
    z-index: 1;
}

#content {
    text-align: center;
    z-index: 2;
    padding-top: 60px;
    margin: 0 auto;
    max-width: 95%;
    width: 1000px;
    font-family: 'Montserrat', sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

#content > h1 {
    margin-top: 0;
    font-size: 50px;
    color: #f49e27;
}

#content > p {
    font-size: 26px;
    line-height: 1.5;
}

#content small {
    color: #f49e27;
}

#logo {
    width: 350px;
    padding: 0 0 30px;
    margin-top: 4vh;
}

.gears {
    background-color: #2c76b6;
    float: left;
    width: 100%;
    height: 46vh;
    position: absolute;
    bottom: 0;
    overflow: hidden;
}

.blink_me {
  animation: blinker 4s linear infinite;
}

@keyframes blinker {  
  0% { opacity: 0; }
  17% { opacity: 0; }
  18% { opacity: 1; }
  20% { opacity: 1; }
  21% { opacity: 0; }
  100% { opacity: 0; }
}

.character {
    position: absolute;
    width: 36vw;
    max-width: 500px;
    height: 500px;
    bottom: 0;
    z-index: 10;
}

.character img {
    position: absolute;
    bottom: 0;
}

.character-arm {
    -webkit-transform: rotate(-40deg);
    -moz-transform: rotate(-40deg);
    -o-transform: rotate(-40deg);
    -ms-transform: rotate(-40deg);
    transform: rotate(-40deg);
    -webkit-animation: arm 1.5s alternate infinite; /* Safari 4+ */
    -moz-animation:    arm 1.5s alternate infinite; /* Fx 5+ */
    -o-animation:      arm 1.5s alternate infinite; /* Opera 12+ */
    animation:         arm 1.5s alternate infinite; /* IE 10+, Fx 29+ */
    -webkit-transform-origin: 50% 100%;
    -moz-transform-origin: 50% 100%;
    -o-transform-origin: 50% 100%;
    -ms-transform-origin: 50% 100%;
    transform-origin: 50% 100%;
    -webkit-animation-timing-function: ease; /* Chrome, Safari, Opera */
    animation-timing-function: ease;
}

/* Chrome, Safari, Opera */ 
@-webkit-keyframes arm {
    0% {
        -webkit-transform: rotate(-30deg);
        -moz-transform: rotate(-30deg);
        -o-transform: rotate(-30deg);
        -ms-transform: rotate(-30deg);
    }



    100% {
        -webkit-transform: rotate(30deg);
        -moz-transform: rotate(30deg);
        -o-transform: rotate(30deg);
        -ms-transform: rotate(30deg);
        transform: rotate(30deg);}
    } 

/* Standard syntax */ 
@keyframes arm {
    
    0% {
        -webkit-transform: rotate(-30deg);
        -moz-transform: rotate(-30deg);
        -o-transform: rotate(-30deg);
        -ms-transform: rotate(-30deg);
        transform: rotate(-30deg);
    }


    100% {
        -webkit-transform: rotate(30deg);
        -moz-transform: rotate(30deg);
        -o-transform: rotate(30deg);
        -ms-transform: rotate(30deg);
        transform: rotate(30deg);}
}

@media only screen and (max-width: 1550px) {
    
    #logo {
        width: 250px;
    }
    
    #content > h1 {
        font-size: 40px;
    }
    
    #content > p {
        font-size: 20px;
    }
    
    .character {
        width: 26vw;
    }
    
    #content {
        padding-top: 20px;
    }
}

@media only screen and (max-width: 767px) {
    
    #logo { 
        margin-top: 0;
        width: 200px;
    }
    
    #content > h1 {
        font-size: 30px;
    }
    
    #gears {
        left: 200px;
    }
    
    .gears {
        position: relative;
        margin-top: 40px;
    }
    
    .character {
        width: 60vw;
        max-width: 300px;
    }
}


</style>

</head>

<body>
    <div id="content">
        <img id="logo" src="/static/cubane/backend/img/cubane-logo-crash-page.svg" alt="InnerShed">
        <h1>500 - Oops, something went wrong!</h1>
        <p>We are trying to keep things working here, but someone keeps throwing a monkey wrench in the works. Please try again later, while we work hard to fix the issue.</p>
    </div>
    <div class="gears">
        <canvas id="gears"></canvas>
        <div class="character">
            <img class="character-arm" src="/static/cubane/backend/img/monkey-arm.svg" alt="InnerShed">
            <img src="/static/cubane/backend/img/monkey-body.svg" alt="InnerShed">
            <img class="blink_me" src="/static/cubane/backend/img/monkey-body-blink.svg" alt="InnerShed">
        </div>
    </div>
</body>

<script>

(function (globals){
"use strict";


/*
 * Resize canvas
 */
var updateConvasPosition = function () {
    var canvas = document.getElementById('gears');
    var w = document.documentElement.clientWidth;
    var h = document.documentElement.clientHeight;
    var ch = 500;
    if ( ch + 200 > h ) ch = h - 200;
    var y = (h - ch) / 2;

    canvas.setAttribute('width', w);
    canvas.setAttribute('height', ch);


    var logo = document.getElementById('logo');
};
updateConvasPosition();
window.onresize = updateConvasPosition;

/*
 * Request animation frame
 */
window.requestAnimFrame = (function(callback) {
    return (
        window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
            window.setTimeout(callback, 1000 / 60);
        }
    );
})();


/*
 * Gear constructor
 */
var Gear = function (config) {
    this.x = config.x;
    this.y = config.y;
    this.spikes = config.spikes;
    this.radius = config.radius;
    this.holeRadius = config.holeRadius;
    this.innerRadius = config.innerRadius;
    this.numTeeth = config.numTeeth;
    this.theta = config.theta;
    this.thetaSpeed = config.thetaSpeed / 1000;
    this.lightColor = config.lightColor;
    this.darkColor = config.darkColor;
    this.clockwise = config.clockwise;
}


/*
 * Gear draw method
 */
Gear.prototype.draw = function() {
    var canvas = document.getElementById('gears');
    var ctx = canvas.getContext('2d');
    ctx.save();

    // enable shadow
    ctx.shadowColor = 'rgba(0, 0, 0, 0.1)';
    ctx.shadowBlur = 2;
    ctx.shadowOffsetX = -4;
    ctx.shadowOffsetY = 4;

    // draw gear teeth
    ctx.beginPath();
    ctx.lineJoin = 'bevel';
    var numPoints = this.numTeeth * 2;
    for (var n = 0; n < numPoints; n++) {
        var radius = null;

        if (n % 2 == 0) {
            radius = this.radius + 8;
        } else {
            radius = this.radius - 8;
        }

        var theta = this.theta;
        theta += ((Math.PI * 2) / numPoints) * (n + 1);

        var x = (radius * Math.sin(theta)) + this.x;
        var y = (radius * Math.cos(theta)) + this.y;

        if (n == 0) {
            ctx.moveTo(x, y);
        } else {
            ctx.lineTo(x, y);
        }
    }
    ctx.closePath();
    ctx.lineWidth = 6;
    ctx.strokeStyle = this.darkColor;
    ctx.stroke();

    // draw gear body
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI, false);
    ctx.arc(this.x, this.y, this.holeRadius, 0, 2 * Math.PI, true);
    var spikeWidth = Math.PI * 2 / (this.spikes * 4);
    for ( var i = 0; i < this.spikes; i++ ) {
        var theta = this.theta + ( ((Math.PI * 2) / this.spikes) * (i + 1) );
        var p3x = (this.innerRadius * Math.sin(theta + spikeWidth)) + this.x;
        var p3y = (this.innerRadius * Math.cos(theta + spikeWidth)) + this.y;
        var p4x = (this.innerRadius * Math.sin(theta - spikeWidth)) + this.x;
        var p4y = (this.innerRadius * Math.cos(theta - spikeWidth)) + this.y;

        var offset = -Math.PI * 0.5 + Math.PI;

        ctx.moveTo(p4x, p4y);
        ctx.arc(this.x, this.y, this.holeRadius, offset - theta + spikeWidth, offset - theta - spikeWidth, true);
        ctx.lineTo(p3x, p3y);
    }
    ctx.closePath();
    var grd = ctx.createLinearGradient(this.x - 100, this.y - 100, this.x + 100, this.y + 100);
    grd.addColorStop(0, this.lightColor);
    grd.addColorStop(1, this.darkColor);
    ctx.fillStyle = grd;
    ctx.fill();

    // turn off shadow
    ctx.shadowBlur = 0;
    ctx.shadowOffsetX = 0;
    ctx.shadowOffsetY = 0;

    // strokes
    // outer border
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI, false);
    ctx.closePath();
    ctx.strokeStyle = this.darkColor;
    ctx.lineWidth = 4;
    ctx.stroke();

    // middle border
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.holeRadius, 0, 2 * Math.PI, false);
    ctx.closePath();
    ctx.strokeStyle = this.darkColor;
    ctx.lineWidth = 2;
    ctx.stroke();

    // inner border
    ctx.beginPath();
    ctx.arc(this.x, this.y, Math.max(0, this.innerRadius - 5), 0, 2 * Math.PI, false);
    ctx.closePath();
    ctx.strokeStyle = this.darkColor;
    ctx.lineWidth = 10;
    ctx.stroke();


};


var animate = function (gears, lastTime) {
    var canvas = document.getElementById('gears');
    var ctx = canvas.getContext('2d');

    // update
    var time = (new Date()).getTime();
    var timeDiff = time - lastTime;

    for(var i = 0; i < gears.length; i++) {
        var gear = gears[i];

        if (gears[i].clockwise) {
            gears[i].theta -= (gear.thetaSpeed * timeDiff);
        } else {
            gears[i].theta += (gear.thetaSpeed * timeDiff);
        }
    }

    // clear
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // draw
    for (var i = 0; i < gears.length; i++) {
        gears[i].draw(timeDiff);
    }

    // request new frame
    requestAnimFrame(function() {
        animate(gears, time);
    });
};


/*
 * Construct scene
 */
var createScene = function () {
    var gears = [];

    // small right 1
    gears.push(new Gear({
        x: 1640,
        y: 460,
        spikes: 5,
        radius: 60,
        holeRadius: 50,
        innerRadius: 20,
        numTeeth: 24,
        theta: 1,
        thetaSpeed: 1,
        lightColor: '#174F79',
        darkColor: '#174F79',
        clockwise: false
    }));

    // small right 2
    gears.push(new Gear({
        x: 1505,
        y: 460,
        spikes: 5,
        radius: 60,
        holeRadius: 50,
        innerRadius: 20,
        numTeeth: 24,
        theta: 2,
        thetaSpeed: 1,
        lightColor: '#174F79',
        darkColor: '#174F79',
        clockwise: true
    }));

    // small right 3
    gears.push(new Gear({
        x: 1370,
        y: 460,
        spikes: 5,
        radius: 60,
        holeRadius: 50,
        innerRadius: 20,
        numTeeth: 24,
        theta: 0,
        thetaSpeed: 1,
        lightColor: '#174F79',
        darkColor: '#174F79',
        clockwise: false
    }));

    // small gear left background
    gears.push(new Gear({
        x: 960,
        y: 50,
        spikes: 3,
        radius: 100,
        holeRadius: 80,
        innerRadius: 30,
        numTeeth: 24,
        theta: 0,
        thetaSpeed: 0.68,
        lightColor: '#174F79',
        darkColor: '#174F79',
        clockwise: true
    }));

    // big gear right
    gears.push(new Gear({
        x: 1100,
        y: 420,
        spikes: 5,
        radius: 200,
        holeRadius: 160,
        innerRadius: 100,
        numTeeth: 64,
        theta: 0.25,
        thetaSpeed: 0.25,
        lightColor: '#174F79',
        darkColor: '#174F79',
        clockwise: true
    }));

    // big gear left
    gears.push(new Gear({
        x: 500,
        y: 280,
        spikes: 6,
        radius: 400,
        holeRadius: 360,
        innerRadius: 200,
        numTeeth: 128,
        theta: 0,
        thetaSpeed: 0.125,
        lightColor: '#174F79',
        darkColor: '#174F79',
        clockwise: false
    }));

    // blue gear
    gears.push(new Gear({
        x: 120,
        y: 105,
        spikes: 5,
        radius: 80,
        holeRadius: 60,
        innerRadius: 20,
        numTeeth: 24,
        theta: 0,
        thetaSpeed: 1,
        lightColor: '#f49e27',
        darkColor: '#f49e27',
        clockwise: false
    }));

    // red gear
    gears.push(new Gear({
        x: 222,
        y: 190,
        spikes: 5,
        radius: 40,
        holeRadius: 20,
        innerRadius: 0,
        numTeeth: 16,
        theta: 0.14,
        thetaSpeed: 2,
        lightColor: '#f49e27',
        darkColor: '#f49e27',
        clockwise: true
    }));

    // orage gear
    gears.push(new Gear({
        x: 272,
        y: 142,
        spikes: 5,
        radius: 18,
        holeRadius: 10,
        innerRadius: 7,
        numTeeth: 10,
        theta: 0.14,
        thetaSpeed: 4,
        lightColor: '#f49e27',
        darkColor: '#f49e27',
        clockwise: false
    }));

    // green gear
    gears.push(new Gear({
        x: 463,
        y: 144,
        spikes: 2,
        radius: 160,
        holeRadius: 120,
        innerRadius: 30,
        numTeeth: 48,
        theta: 0,
        thetaSpeed: 0.5,
        lightColor: '#3785c9',
        darkColor: '#3785c9',
        clockwise: true
    }));

    // green gear
    gears.push(new Gear({
        x: 800,
        y: 510,
        spikes: 3,
        radius: 320,
        holeRadius: 280,
        innerRadius: 200,
        numTeeth: 64,
        theta: 0,
        thetaSpeed: 0.5,
        lightColor: '#4093da',
        darkColor: '#4093da',
        clockwise: false
    }));

    return gears;
};


/*
 * Main
 */
(function () {
    var gears = createScene();
    var time = (new Date()).getTime();
    animate(gears, time);
})();


}(this));

</script>

</html>
