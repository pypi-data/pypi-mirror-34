#!/usr/bin/python
#coding=utf-8

from hashlib import md5
from base64 import b64decode
from base64 import b64encode
from Crypto import Random
from Crypto.Cipher import AES
import hashlib
import base64
import re

# Padding for the input string --not
# related to encryption itself.

from Crypto.Cipher import AES
from binascii import b2a_hex, a2b_hex

class AESCypt():
    def __init__(self, key, mode = AES.MODE_CBC):
        self.key = key
        self.mode = mode

    # 加密函数，如果text不足16位就用空格补足为16位，
    # 如果大于16当时不是16的倍数，那就补足为16的倍数。
    def encrypt(self, text):
        cryptor = AES.new(self.key, self.mode, b'0000000000000000')
        # 这里密钥key 长度必须为16（AES-128）,
        # 24（AES-192）,或者32 （AES-256）Bytes 长度
        # 目前AES-128 足够目前使用
        length = 16
        count = len(text)
        if count < length:
            add = (length - count)
            # \0 backspace
            text = text + ('\0' * add)
        elif count > length:
            add = (length - (count % length))
            text = text + ('\0' * add)
        self.ciphertext = cryptor.encrypt(text)
        # 因为AES加密时候得到的字符串不一定是ascii字符集的，输出到终端或者保存时候可能存在问题
        # 所以这里统一把加密后的字符串转化为16进制字符串
        return base64.encodestring(self.ciphertext).replace("\n", "")

    # 解密后，去掉补足的空格用strip() 去掉
    def decrypt(self, text):
        cryptor = AES.new(self.key, self.mode, b'0000000000000000')
        plain_text = cryptor.decrypt(base64.decodestring(text))
        # plain_text = cryptor.decrypt(a2b_hex(text))
        return plain_text.rstrip('\0')

if __name__ == '__main__':
    pc = AESCypt('c1d4a646adcc4b99') #初始化密钥
    import sys
    # e = pc.encrypt("高级加密标准（Advanced Encryption Standard，AES），在密码学中又称Rijndael加密法") #加密
    d = pc.decrypt("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") #解密
    print "解密:",d


