
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>10. Configuring the server &#8212; CamCOPS 2.2.4 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/camcops_docs.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. The CamCOPS server configuration file" href="server_config_file.html" />
    <link rel="prev" title="9. Installing CamCOPS on the server" href="server_installation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="server_config_file.html" title="11. The CamCOPS server configuration file"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="server_installation.html" title="9. Installing CamCOPS on the server"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CamCOPS 2.2.4 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="configuring-the-server">
<span id="server-configuration"></span><h1>10. Configuring the server<a class="headerlink" href="#configuring-the-server" title="Permalink to this headline">¶</a></h1>
<p>The majority of CamCOPS configuration takes place via the <a class="reference internal" href="server_config_file.html#server-config-file"><span class="std std-ref">server
configuration file</span></a>. Here, we deal with everything else.</p>
<div class="section" id="overview">
<h2>10.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>CamCOPS will operate offline on your tablet, and you can view simple
summaries of your tasks there.</li>
<li>You should set up a server to receive data from your CamCOPS tablet(s).<ul>
<li>The simplest way (involving only free software) is to set up a <a class="reference external" href="http://en.wikipedia.org/wiki/Linux">Linux</a>
(e.g. <a class="reference external" href="http://www.ubuntu.com/">Ubuntu</a>) computer with an <a class="reference external" href="http://httpd.apache.org/">Apache</a> web server and a <a class="reference external" href="http://www.mysql.com/">MySQL</a> database
(plus the <a class="reference external" href="https://www.python.org/">Python</a> interpreter, which comes with most Linux
distributions) – collectively known as a LAMP stack <a class="footnote-reference" href="#lamp" id="id1">[2]</a>. Alternative
(e.g. Windows) configurations are possible, but we’ve not used them so do
not provide details here.</li>
<li>You must also obtain an <a class="reference external" href="http://en.wikipedia.org/wiki/HTTP_Secure">HTTPS</a> certificate (or create one for free
<a class="footnote-reference" href="#snakeoil" id="id2">[3]</a> – not recommended), and configure your web server to do all
its CamCOPS work via HTTPS only (not HTTP), so that your information is
always encrypted in transit from the tablets to your server. The CamCOPS
tablet app will not use unencrypted links. (Where do certificates live on
disk? See <a class="footnote-reference" href="#linuxflavours" id="id3">[1]</a>.)</li>
<li>Then, CamCOPS provides software so your web server can receive data from
your tablets, and offers a <a class="reference internal" href="server_front_end_general.html#website-general"><span class="std std-ref">web front end</span></a> so you
can view your tasks in HTML and PDF format, and download data in various
formats.</li>
<li>For very advanced analysis, you can use the MySQL database directly.</li>
<li>You must also consider the server’s security carefully; see <a class="reference internal" href="../introduction/security_design.html#security-design"><span class="std std-ref">Security</span></a>.</li>
</ul>
</li>
<li>Having set up your server, you should point your tablet(s) to it (see
<a class="reference internal" href="../client/client_installation.html#configure-client"><span class="std std-ref">configuring the tablet application</span></a>).</li>
</ul>
</div>
<div class="section" id="data-flow">
<h2>10.2. Data flow<a class="headerlink" href="#data-flow" title="Permalink to this headline">¶</a></h2>
<p>A generic CamCOPS server is arranged like this:</p>
<img alt="../_images/server_diagram.png" src="../_images/server_diagram.png" />
<p>Most servers will use a single database and a single CamCOPS instance, because
this is simpler and more powerful. In that simpler case, ignore all reference
to “instances” in the figure above.</p>
<p>There are two web servers in this diagram.</p>
<ul class="simple">
<li>The <strong>front-end web server</strong> talks to the “world”. Users connect to it.
Choose a high-performance web server capable of serving static files.<ul>
<li>A good choice, regardless of OS, is <a class="reference external" href="http://httpd.apache.org/">Apache</a>.</li>
</ul>
</li>
<li>The <strong>back-end web server</strong> is bundled with CamCOPS. Its code lives in the
CamCOPS Python virtual environment. Its job is to serve CamCOPS, and only
CamCOPS, to an internal TCP/IP port (or UNIX socket). The front-end web
server then routes appropriate requests through to it. CamCOPS offers a
choice:<ul>
<li><a class="reference external" href="http://gunicorn.org/">Gunicorn</a> is probably the best choice for deployment under Linux/UNIX. It’s
pretty quick. It relies on the UNIX <cite>fork()</cite> function <a class="footnote-reference" href="#fork" id="id4">[5]</a>, so it
doesn’t run under Windows.</li>
<li><a class="reference external" href="https://cherrypy.org/">CherryPy</a> is a good cross-platform choice, and definitely the best choice
under Windows.</li>
<li><a class="reference external" href="https://trypyramid.com/">Pyramid</a> is the web framework that CamCOPS uses, and it comes with its own
demonstration server. This is handy for running the very helpful Pyramid
debug toolbar <a class="footnote-reference" href="#pyramiddebugtoolbar" id="id5">[4]</a> during testing, but it is definitely
not a good choice for deployment.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configure-your-firewall">
<h2>10.3. Configure your firewall<a class="headerlink" href="#configure-your-firewall" title="Permalink to this headline">¶</a></h2>
<p>Ensure your firewall is configured properly:</p>
<ul class="simple">
<li>You’ll need to allow HTTPS through, for tablet communications and the web
viewer. (The default port is 443; see <a class="reference internal" href="../misc/tcpip_ports.html#tcpip-ports"><span class="std std-ref">TCP/IP ports</span></a>. It’s
possible to use another, but it will confuse users.)</li>
<li>You’ll probably want remote SSH access, either through the default port (22),
or a secret port known only to you.</li>
<li>Other ports are up to you. If you want to run a plain web server as well,
that’ll normally be on port 80. Access to CamCOPS should only be via HTTPS,
not plain HTTP.</li>
<li>Disable access to everything you don’t need.</li>
</ul>
</div>
<div class="section" id="create-a-database">
<span id="create-database"></span><h2>10.4. Create a database<a class="headerlink" href="#create-a-database" title="Permalink to this headline">¶</a></h2>
<p>The method to create a database depends on the database engine you plan to use.
Here’s a method for MySQL to create a database named <cite>camcops</cite>.</p>
<p>First, from the Linux command line, log in to MySQL as root:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mysql --host<span class="o">=</span><span class="m">127</span>.0.0.1 --port<span class="o">=</span><span class="m">3306</span> --user<span class="o">=</span>root --password
<span class="c1"># ... or the usual short form: mysql -u root -p</span>
</pre></div>
</div>
<p>Then in MySQL:</p>
<div class="highlight-mysql notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the database:</span>

<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">camcops</span><span class="p">;</span>

<span class="c1"># Ideally, create another user that only has access to the CamCOPS database.</span>
<span class="c1"># You should do this, so that you don’t use the root account unnecessarily.</span>

<span class="k">GRANT</span> <span class="k">ALL</span> <span class="n">PRIVILEGES</span> <span class="k">ON</span> <span class="n">camcops</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;YYYYYY_REPLACE_ME&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;ZZZZZZ_REPLACE_ME&#39;</span><span class="p">;</span>

<span class="c1"># For future use: if you plan to explore your database directly for analysis,</span>
<span class="c1"># you may want to create a read-only user. Though it may not be ideal (check:</span>
<span class="c1"># are you happy the user can see the audit trail?), you can create a user with</span>
<span class="c1"># read-only access to the entire database like this:</span>

<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="n">camcops</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;QQQQQQ_REPLACE_ME&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;PPPPPP_REPLACE_ME&#39;</span><span class="p">;</span>

<span class="c1"># All done. Quit MySQL:</span>

<span class="k">exit</span>
</pre></div>
</div>
</div>
<div class="section" id="create-edit-a-camcops-config-file">
<h2>10.5. Create/edit a CamCOPS config file<a class="headerlink" href="#create-edit-a-camcops-config-file" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="server_config_file.html#server-config-file"><span class="std std-ref">“The CamCOPS server configuration file”</span></a>.</p>
<p>The file is typically called <cite>/etc/camcops/camcops.conf</cite> and should be readable
by the web server user, such as <cite>www-data</cite> under Ubuntu <a class="footnote-reference" href="#linuxflavours" id="id6">[1]</a>.</p>
</div>
<div class="section" id="create-the-database-structure">
<h2>10.6. Create the database structure<a class="headerlink" href="#create-the-database-structure" title="Permalink to this headline">¶</a></h2>
<p>To create tables and indices, use the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>camcops upgrade_db --config CONFIG
</pre></div>
</div>
<p>where CONFIG is the filename of your configuration file. If your configuration
file is only readable as <cite>www-data</cite>, you will need to run this with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo -u www-data camcops upgrade_db --config CONFIG
</pre></div>
</div>
</div>
<div class="section" id="create-a-superuser">
<h2>10.7. Create a superuser<a class="headerlink" href="#create-a-superuser" title="Permalink to this headline">¶</a></h2>
<p>Use the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>camcops make_superuser --config CONFIG
</pre></div>
</div>
<p>where CONFIG is the filename of your configuration file. (Again, use <code class="docutils literal notranslate"><span class="pre">sudo</span></code>
as above if your configuration file requires privileged access to read.)</p>
</div>
<div class="section" id="start-camcops">
<h2>10.8. Start CamCOPS<a class="headerlink" href="#start-camcops" title="Permalink to this headline">¶</a></h2>
<p>Under Linux, this is best done via <a class="reference external" href="http://supervisord.org/">Supervisor</a>, which launches programs, keeps
log files for them, and restarts them when the computer is rebooted.</p>
<p>To generate a specimen Supervisor configuration file for CamCOPS, run the
command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>camcops demo_supervisor_config &gt; my_demo_camcops_supervisor_config.conf
</pre></div>
</div>
<p>Here’s an example, which you would typically save as
<cite>/etc/supervisor/conf.d/camcops.conf</cite>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># =============================================================================</span>
<span class="c1"># Demonstration &#39;supervisor&#39; config file for CamCOPS.</span>
<span class="c1"># Created by CamCOPS version 2.2.1 at 2018-06-08T18:03:08.640489+01:00.</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># - Supervisor is a system for controlling background processes running on</span>
<span class="c1">#   UNIX-like operating systems. See:</span>
<span class="c1">#       http://supervisord.org</span>
<span class="c1"># - On Ubuntu systems, you would typically install supervisor with</span>
<span class="c1">#       sudo apt install supervisor</span>
<span class="c1">#   and then save this file as</span>
<span class="c1">#       /etc/supervisor/conf.d/camcops.conf</span>
<span class="c1">#</span>
<span class="c1"># - IF YOU EDIT THIS FILE, run:</span>
<span class="c1">#       sudo service supervisor restart</span>
<span class="c1"># - TO MONITOR SUPERVISOR, run:</span>
<span class="c1">#       sudo supervisorctl status</span>
<span class="c1">#   ... or just &quot;sudo supervisorctl&quot; for an interactive prompt.</span>
<span class="c1">#</span>
<span class="c1"># - TO ADD MORE CAMCOPS INSTANCES, first consider whether you wouldn&#39;t be</span>
<span class="c1">#   better off just adding groups. If you decide you want a completely new</span>
<span class="c1">#   instance, make a copy of the [program:camcops] section, renaming the copy,</span>
<span class="c1">#   and change the following:</span>
<span class="c1">#   - the --config switch;</span>
<span class="c1">#   - the port or socket;</span>
<span class="c1">#   - the log files.</span>
<span class="c1">#   Then make the main web server point to the copy as well.</span>
<span class="c1">#</span>
<span class="c1"># NOTES ON THE SUPERVISOR CONFIG FILE AND ENVIRONMENT:</span>
<span class="c1"># - Indented lines are treated as continuation (even in commands; no need for</span>
<span class="c1">#   end-of-line backslashes or similar).</span>
<span class="c1"># - The downside of that is that indented comment blocks can join onto your</span>
<span class="c1">#   commands! Beware that.</span>
<span class="c1"># - You can&#39;t put quotes around the directory variable</span>
<span class="c1">#   http://stackoverflow.com/questions/10653590</span>
<span class="c1"># - Python programs that are installed within a Python virtual environment</span>
<span class="c1">#   automatically use the virtualenv&#39;s copy of Python via their shebang; you do</span>
<span class="c1">#   not need to specify that by hand, nor the PYTHONPATH.</span>
<span class="c1"># - The &quot;environment&quot; setting sets the OS environment. The &quot;--env&quot; parameter</span>
<span class="c1">#   to gunicorn, if you use it, sets the WSGI environment.</span>

<span class="k">[program:camcops]</span>

<span class="na">command</span> <span class="o">=</span> <span class="s">/home/rudolf/dev/venvs/camcops/bin/camcops</span>
<span class="s">    serve_gunicorn</span>
<span class="s">    --config /etc/camcops/camcops.conf</span>
<span class="s">    --unix_domain_socket /tmp/.camcops.sock</span>
<span class="s">    --trusted_proxy_headers</span>
<span class="s">        HTTP_X_FORWARDED_HOST</span>
<span class="s">        HTTP_X_FORWARDED_SERVER</span>
<span class="s">        HTTP_X_FORWARDED_PORT</span>
<span class="s">        HTTP_X_FORWARDED_PROTO</span>
<span class="s">        HTTP_X_SCRIPT_NAME</span>

<span class="c1"># To run via a TCP socket, use e.g.:</span>
<span class="c1">#   --host 127.0.0.1 --port 8000</span>
<span class="c1"># To run via a UNIX domain socket, use e.g.</span>
<span class="c1">#   --unix_domain_socket /tmp/.camcops.sock</span>

<span class="na">directory</span> <span class="o">=</span> <span class="s">/home/rudolf/Documents/code/camcops/server/camcops_server</span>

<span class="na">environment</span> <span class="o">=</span> <span class="s">MPLCONFIGDIR=&quot;/var/cache/camcops/matplotlib&quot;</span>

<span class="c1"># MPLCONFIGDIR specifies a cache directory for matplotlib, which greatly</span>
<span class="c1"># speeds up its subsequent loading.</span>

<span class="na">user</span> <span class="o">=</span> <span class="s">www-data</span>

<span class="c1"># ... Ubuntu: typically www-data</span>
<span class="c1"># ... CentOS: typically apache</span>

<span class="na">stdout_logfile</span> <span class="o">=</span> <span class="s">/var/log/supervisor/camcops_out.log</span>
<span class="na">stderr_logfile</span> <span class="o">=</span> <span class="s">/var/log/supervisor/camcops_err.log</span>

<span class="na">autostart</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">autorestart</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">startsecs</span> <span class="o">=</span> <span class="s">30</span>
<span class="na">stopwaitsecs</span> <span class="o">=</span> <span class="s">60</span>
</pre></div>
</div>
<p>This is where you choose which back-end web server CamCOPS should use (see
above), by choosing the command you pass to <cite>camcops</cite>. For high-performance
work under Linux, use Gunicorn, with the <cite>serve_gunicorn</cite> command; see the
<a class="reference internal" href="server_command_line.html#camcops-cli"><span class="std std-ref">options for the camcops command</span></a>.</p>
</div>
<div class="section" id="point-the-front-end-web-server-to-camcops">
<span id="configure-apache"></span><h2>10.9. Point the front-end web server to CamCOPS<a class="headerlink" href="#point-the-front-end-web-server-to-camcops" title="Permalink to this headline">¶</a></h2>
<p>Under Linux, a typicaly front-end web server is <a class="reference external" href="http://httpd.apache.org/">Apache</a>.</p>
<p>To generate a specimen Apache configuration file for CamCOPS, run the command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>camcops demo_apache_config &gt; demo_apache_config_chunk.txt
</pre></div>
</div>
<p>Here’s an example to mount CamCOPS at the URL path <cite>/camcops</cite>, which you would
edit into the Apache config file <a class="footnote-reference" href="#linuxflavours" id="id7">[1]</a>:</p>
<div class="highlight-apacheconf notranslate"><div class="highlight"><pre><span></span>    <span class="c"># Demonstration Apache config file section for CamCOPS.</span>
    <span class="c"># Created by CamCOPS version 2.2.0 at 2018-06-08T19:52:03.221011+01:00.</span>
    <span class="c">#</span>
    <span class="c"># Under Ubuntu, the Apache config will be somewhere in /etc/apache2/</span>
    <span class="c"># Under CentOS, the Apache config will be somewhere in /etc/httpd/</span>
    <span class="c">#</span>
    <span class="c"># This section should go within the &lt;VirtualHost&gt; directive for the secure</span>
    <span class="c"># (SSL, HTTPS) part of the web site.</span>

<span class="nt">&lt;VirtualHost</span> <span class="s">*:443</span><span class="nt">&gt;</span>
    <span class="c"># ...</span>

    <span class="c"># =========================================================================</span>
    <span class="c"># CamCOPS</span>
    <span class="c"># =========================================================================</span>
    <span class="c"># Apache operates on the principle that the first match wins. So, if we</span>
    <span class="c"># want to serve CamCOPS but then override some of its URLs to serve static</span>
    <span class="c"># files faster, we define the static stuff first.</span>

        <span class="c"># ---------------------------------------------------------------------</span>
        <span class="c"># 1. Serve static files</span>
        <span class="c"># ---------------------------------------------------------------------</span>
        <span class="c"># a) offer them at the appropriate URL</span>
        <span class="c"># b) provide permission</span>
        <span class="c"># c) disable ProxyPass for static files</span>

        <span class="c"># Change this: aim the alias at your own institutional logo.</span>

    <span class="nb">Alias</span> <span class="sx">/camcops/static/logo_local.png</span> <span class="sx">/usr/share/camcops/venv/lib/python3.5/site-packages/camcops_server/static/logo_local.png</span>

        <span class="c"># We move from more specific to less specific aliases; the first match</span>
        <span class="c"># takes precedence. (Apache will warn about conflicting aliases if</span>
        <span class="c"># specified in a wrong, less-to-more-specific, order.)</span>

    <span class="nb">Alias</span> <span class="sx">/camcops/static/</span> <span class="sx">/usr/share/camcops/venv/lib/python3.5/site-packages/camcops_server/static/</span>

    <span class="nt">&lt;Directory</span> <span class="s">/usr/share/camcops/venv/lib/python3.5/site-packages/camcops_server/static</span><span class="nt">&gt;</span>
        <span class="nb">Require</span> <span class="k">all</span> granted

        <span class="c"># ... for old Apache version (e.g. 2.2), use instead:</span>
        <span class="c"># Order allow,deny</span>
        <span class="c"># Allow from all</span>
    <span class="nt">&lt;/Directory&gt;</span>

        <span class="c"># Don&#39;t ProxyPass the static files; we&#39;ll serve them via Apache.</span>

    <span class="nb">ProxyPassMatch</span> ^/camcops/static/ !

        <span class="c"># ---------------------------------------------------------------------</span>
        <span class="c"># 2. Proxy requests to the CamCOPS web server and back; allow access</span>
        <span class="c"># ---------------------------------------------------------------------</span>
        <span class="c"># ... either via an internal TCP/IP port (e.g. 1024 or higher, and NOT</span>
        <span class="c">#     accessible to users);</span>
        <span class="c"># ... or, better, via a Unix socket, e.g. /tmp/.camcops.sock</span>
        <span class="c">#</span>
        <span class="c"># NOTES</span>
        <span class="c"># - When you ProxyPass /camcops, you should browse to</span>
        <span class="c">#       https://YOURSITE/camcops</span>
        <span class="c">#   and point your tablet devices to</span>
        <span class="c">#       https://YOURSITE/camcops/database</span>
        <span class="c"># - Don&#39;t specify trailing slashes for the ProxyPass and</span>
        <span class="c">#   ProxyPassReverse directives.</span>
        <span class="c">#   If you do, http://host/camcops will fail though</span>
        <span class="c">#              http://host/camcops/ will succeed.</span>
        <span class="c"># - Ensure that you put the CORRECT PROTOCOL (http, https) in the rules</span>
        <span class="c">#   below.</span>
        <span class="c"># - For ProxyPass options, see https://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypass</span>
        <span class="c">#   ... including &quot;retry=0&quot; to stop Apache disabling the connection for</span>
        <span class="c">#       a while on failure.</span>
        <span class="c"># - Using a socket</span>
        <span class="c">#   - this requires Apache 2.4.9, and passes after the &#39;|&#39; character a</span>
        <span class="c">#     URL that determines the Host: value of the request; see</span>
        <span class="c">#     https://httpd.apache.org/docs/trunk/mod/mod_proxy.html#proxypass</span>
        <span class="c"># - CamCOPS MUST BE TOLD about its location and protocol, because that</span>
        <span class="c">#   information is critical for synthesizing URLs, but is stripped out</span>
        <span class="c">#   by the reverse proxy system. There are two ways:</span>
        <span class="c">#   (i)  specifying headers or WSGI environment variables, such as</span>
        <span class="c">#        the HTTP(S) headers X-Forwarded-Proto and X-Script-Name below</span>
        <span class="c">#        (CamCOPS is aware of these);</span>
        <span class="c">#   (ii) specifying options to &quot;camcops serve&quot;, including</span>
        <span class="c">#           --script_name</span>
        <span class="c">#           --scheme</span>
        <span class="c">#        and optionally</span>
        <span class="c">#           --server</span>
        <span class="c">#</span>
        <span class="c"># So:</span>
        <span class="c">#</span>
        <span class="c"># ~~~~~~~~~~~~~~~~~</span>
        <span class="c"># (a) Reverse proxy</span>
        <span class="c"># ~~~~~~~~~~~~~~~~~</span>
        <span class="c">#</span>
        <span class="c"># PORT METHOD</span>
        <span class="c"># Note the use of &quot;http&quot; (reflecting the backend), not https (like the</span>
        <span class="c"># front end).</span>

    <span class="nb">ProxyPass</span> <span class="sx">/camcops</span> http://127.0.0.1:8000 retry=0
    <span class="nb">ProxyPassReverse</span> <span class="sx">/camcops</span> http://127.0.0.1:8000 retry=0

        <span class="c"># UNIX SOCKET METHOD (Apache 2.4.9 and higher)</span>
        <span class="c">#</span>
        <span class="c"># The general syntax is:</span>
        <span class="c">#   ProxyPass /URL_USER_SEES unix:SOCKETFILE|PROTOCOL://HOST/EXTRA_URL_FOR_BACKEND retry=0</span>
        <span class="c"># Note that:</span>
        <span class="c">#   - the protocol should be http, not https (Apache deals with the</span>
        <span class="c">#     HTTPS part and passes HTTP on)</span>
        <span class="c">#   - the EXTRA_URL_FOR_BACKEND needs to be (a) unique for each</span>
        <span class="c">#     instance or Apache will use a single worker for multiple</span>
        <span class="c">#     instances, and (b) blank for the backend&#39;s benefit. Since those</span>
        <span class="c">#     two conflict when there&#39;s &gt;1 instance, there&#39;s a problem.</span>
        <span class="c">#   - Normally, HOST is given as localhost. It may be that this problem</span>
        <span class="c">#     is solved by using a dummy unique value for HOST:</span>
        <span class="c">#     https://bz.apache.org/bugzilla/show_bug.cgi?id=54101#c1</span>
        <span class="c">#</span>
        <span class="c"># If your Apache version is too old, you will get the error</span>
        <span class="c">#   &quot;AH00526: Syntax error on line 56 of /etc/apache2/sites-enabled/SOMETHING:</span>
        <span class="c">#    ProxyPass URL must be absolute!&quot;</span>
        <span class="c"># On Ubuntu, if your Apache is too old, you could use</span>
        <span class="c">#   sudo add-apt-repository ppa:ondrej/apache2</span>
        <span class="c"># ... details at https://launchpad.net/~ondrej/+archive/ubuntu/apache2</span>
        <span class="c">#</span>
        <span class="c"># If you get this error:</span>
        <span class="c">#   AH01146: Ignoring parameter &#39;retry=0&#39; for worker &#39;unix:/tmp/.camcops_gunicorn.sock|https://localhost&#39; because of worker sharing</span>
        <span class="c">#   https://wiki.apache.org/httpd/ListOfErrors</span>
        <span class="c"># ... then your URLs are overlapping and should be redone or sorted:</span>
        <span class="c">#   http://httpd.apache.org/docs/2.4/mod/mod_proxy.html#workers</span>
        <span class="c"># The part that must be unique for each instance, with no part a</span>
        <span class="c"># leading substring of any other, is THIS_BIT in:</span>
        <span class="c">#   ProxyPass /URL_USER_SEES unix:SOCKETFILE|https://localhost/THIS_BIT retry=0</span>
        <span class="c">#</span>
        <span class="c"># If you get an error like this:</span>
        <span class="c">#   AH01144: No protocol handler was valid for the URL /SOMEWHERE. If you are using a DSO version of mod_proxy, make sure the proxy submodules are included in the configuration using LoadModule.</span>
        <span class="c"># Then do this:</span>
        <span class="c">#   sudo a2enmod proxy proxy_http</span>
        <span class="c">#   sudo apache2ctl restart</span>
        <span class="c">#</span>
        <span class="c"># If you get an error like this:</span>
        <span class="c">#   ... [proxy_http:error] [pid 32747] (103)Software caused connection abort: [client 109.151.49.173:56898] AH01102: error reading status line from remote server httpd-UDS:0</span>
        <span class="c">#       [proxy:error] [pid 32747] [client 109.151.49.173:56898] AH00898: Error reading from remote server returned by /camcops_bruhl/webview</span>
        <span class="c"># then check you are specifying http://, not https://, in the ProxyPass</span>
        <span class="c">#</span>
        <span class="c"># Other information sources:</span>
        <span class="c">#   https://emptyhammock.com/projects/info/pyweb/webconfig.html</span>

    <span class="c"># ProxyPass /camcops unix:/tmp/.camcops.sock|https://dummy1/ retry=0</span>
    <span class="c"># ProxyPassReverse /camcops unix:/tmp/.camcops.sock|https://dummy1/ retry=0</span>

        <span class="c"># ~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c"># (b) Allow proxy over SSL.</span>
        <span class="c"># ~~~~~~~~~~~~~~~~~~~~~~~~~</span>
        <span class="c"># Without this, you will get errors like:</span>
        <span class="c">#   ... SSL Proxy requested for wombat:443 but not enabled [Hint: SSLProxyEngine]</span>
        <span class="c">#   ... failed to enable ssl support for 0.0.0.0:0 (httpd-UDS)</span>

    <span class="nb">SSLProxyEngine</span> <span class="k">on</span>

    <span class="nt">&lt;Location</span> <span class="s">/camcops</span><span class="nt">&gt;</span>

            <span class="c"># ~~~~~~~~~~~~~~~~</span>
            <span class="c"># (c) Allow access</span>
            <span class="c"># ~~~~~~~~~~~~~~~~</span>

        <span class="nb">Require</span> <span class="k">all</span> granted

        <span class="c"># ... for old Apache version (e.g. 2.2), use instead:</span>
        <span class="c"># Order allow,deny</span>
        <span class="c"># Allow from all</span>

            <span class="c"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c"># (d) Tell the proxied application that we are using HTTPS, and</span>
            <span class="c">#     where the application is installed</span>
            <span class="c"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
            <span class="c">#     ... https://stackoverflow.com/questions/16042647</span>
            <span class="c">#</span>
            <span class="c"># EITHER enable mod_headers (e.g. &quot;sudo a2enmod headers&quot;) and set:</span>

        <span class="nb">RequestHeader</span> set X-Forwarded-Proto https
        <span class="nb">RequestHeader</span> set X-Script-Name <span class="sx">/camcops</span>

            <span class="c"># and call CamCOPS like:</span>
            <span class="c">#</span>
            <span class="c"># camcops serve_gunicorn \</span>
            <span class="c">#       --config SOMECONFIG \</span>
            <span class="c">#       --trusted_proxy_headers \</span>
            <span class="c">#           HTTP_X_FORWARDED_HOST \</span>
            <span class="c">#           HTTP_X_FORWARDED_SERVER \</span>
            <span class="c">#           HTTP_X_FORWARDED_PORT \</span>
            <span class="c">#           HTTP_X_FORWARDED_PROTO \</span>
            <span class="c">#           HTTP_X_SCRIPT_NAME</span>
            <span class="c">#</span>
            <span class="c"># (X-Forwarded-For, X-Forwarded-Host, and X-Forwarded-Server are</span>
            <span class="c"># supplied by Apache automatically)</span>
            <span class="c">#</span>
            <span class="c"># ... OR specify those options by hand in the CamCOPS command.</span>

    <span class="nt">&lt;/Location&gt;</span>

        <span class="c"># ---------------------------------------------------------------------</span>
        <span class="c"># 3. For additional instances</span>
        <span class="c"># ---------------------------------------------------------------------</span>
        <span class="c"># (a) duplicate section 1 above, editing the base URL and CamCOPS</span>
        <span class="c">#     connection (socket/port);</span>
        <span class="c"># (b) you will also need to create an additional CamCOPS instance,</span>
        <span class="c">#     as above;</span>
        <span class="c"># (c) add additional static aliases (in section 2 above).</span>
        <span class="c">#</span>
        <span class="c"># HOWEVER, consider adding more CamCOPS groups, rather than creating</span>
        <span class="c"># additional instances; the former are *much* easier to administer!</span>


    <span class="c">#==========================================================================</span>
    <span class="c"># SSL security (for HTTPS)</span>
    <span class="c">#==========================================================================</span>

        <span class="c"># You will also need to install your SSL certificate; see the</span>
        <span class="c"># instructions that came with it. You get a certificate by creating a</span>
        <span class="c"># certificate signing request (CSR). You enter some details about your</span>
        <span class="c"># site, and a software tool makes (1) a private key, which you keep</span>
        <span class="c"># utterly private, and (2) a CSR, which you send to a Certificate</span>
        <span class="c"># Authority (CA) for signing. They send back a signed certificate, and</span>
        <span class="c"># a chain of certificates leading from yours to a trusted root CA.</span>
        <span class="c">#</span>
        <span class="c"># You can create your own (a &#39;snake-oil&#39; certificate), but your tablets</span>
        <span class="c"># and browsers will not trust it, so this is a bad idea.</span>
        <span class="c">#</span>
        <span class="c"># Once you have your certificate: edit and uncomment these lines:</span>

    <span class="c"># SSLEngine on</span>

    <span class="c"># SSLCertificateKeyFile /etc/ssl/private/my.private.key</span>

        <span class="c"># ... a private file that you made before creating the certificate</span>
        <span class="c"># request, and NEVER GAVE TO ANYBODY, and NEVER WILL (or your</span>
        <span class="c"># security is broken and you need a new certificate).</span>

    <span class="c"># SSLCertificateFile /etc/ssl/certs/my.public.cert</span>

        <span class="c"># ... signed and supplied to you by the certificate authority (CA),</span>
        <span class="c"># from the public certificate you sent to them.</span>

    <span class="c"># SSLCertificateChainFile /etc/ssl/certs/my-institution.ca-bundle</span>

        <span class="c"># ... made from additional certificates in a chain, supplied to you by</span>
        <span class="c"># the CA. For example, mine is univcam.ca-bundle, made with the</span>
        <span class="c"># command:</span>
        <span class="c">#</span>
        <span class="c"># cat TERENASSLCA.crt UTNAddTrustServer_CA.crt AddTrustExternalCARoot.crt &gt; univcam.ca-bundle</span>

<span class="nt">&lt;/VirtualHost&gt;</span>
</pre></div>
</div>
<p>Once you are happy with your Apache config file:</p>
<ul>
<li><p class="first">Ensure file ownerships/permissions are correct (including, on CentOS, SELinux
permissions <a class="footnote-reference" href="#selinux" id="id8">[6]</a>).</p>
<ul>
<li><p class="first">On Ubuntu, if you use <cite>/srv/www</cite> as your <cite>DocumentRoot</cite>, you may need to
do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo chown -R www-data:www-data /srv/www
</pre></div>
</div>
</li>
<li><p class="first">On CentOS, assuming you use <cite>/var/www</cite> as your <cite>DocumentRoot</cite>, you may need
to do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls -alZ /var/www <span class="c1"># shows owners and SELinux security context</span>

sudo chown -R apache:apache /var/www
sudo chcon -R -h system_u:object_r:httpd_sys_content_t /var/www
sudo chown -R apache:apache /etc/camcops
sudo chcon -R -h system_u:object_r:httpd_sys_content_t /etc/camcops
sudo chown -R apache:apache /var/cache/camcops
sudo chcon -R -h system_u:object_r:httpd_sys_content_t /var/cache/camcops
sudo chown -R apache:apache /usr/share/camcops/server/static
sudo chcon -R -h system_u:object_r:httpd_sys_content_t /usr/share/camcops/server/static
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Restart Apache: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apachectl</span> <span class="pre">restart</span></code>.</p>
</li>
<li><p class="first">Ensure Apache restarts on boot.</p>
<ul>
<li><p class="first">On Ubuntu, this should be automatic.</p>
</li>
<li><p class="first">On CentOS, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo chkconfig --level <span class="m">2345</span> httpd on
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="browse-to-the-web-site">
<h2>10.10. Browse to the web site<a class="headerlink" href="#browse-to-the-web-site" title="Permalink to this headline">¶</a></h2>
<p>If you have configured things correctly, the rest of the configuration should
be possible via the CamCOPS web site.</p>
<p>Assuming you used <cite>/camcops</cite> as the base URL path,</p>
<ul class="simple">
<li>Browse to <cite>https://YOURHOST/camcops/webview</cite>. This should work.</li>
<li>Browse to <cite>http://YOURHOST/camcops/webview</cite>. This should <em>not</em> work; you
shouldn’t allow access via plain HTTP.</li>
<li>Check that a tablet device can register with the server and upload some data
while using the URL <cite>https://YOURHOST/camcops/database</cite>.</li>
</ul>
</div>
<div class="section" id="configure-backups">
<h2>10.11. Configure backups<a class="headerlink" href="#configure-backups" title="Permalink to this headline">¶</a></h2>
<p>Your backup strategy is up to you. However, one option is to use a script to
dump all MySQL databases. A sample script is produced by the command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>camcops demo_mysql_dump_script
</pre></div>
</div>
<p>but even better is this tool:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>camcops_backup_mysql_database
</pre></div>
</div>
<p>If you use this strategy, you will need to save this script and edit the copy.
Be sure your copy of the script is readable only by root and the backup user,
as it contains a password. You can then run your script regularly from
<cite>/etc/crontab</cite> (see <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">cron</span></code>, <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">crontab</span></code>).</p>
<p>Obviously, you will also need the dumped files to be backed up to a physically
secure location regularly.</p>
</div>
<div class="section" id="more-than-one-camcops-instance">
<h2>10.12. More than one CamCOPS instance<a class="headerlink" href="#more-than-one-camcops-instance" title="Permalink to this headline">¶</a></h2>
<p>This is simple to set up, but fiddly to maintain. Try to avoid it! Using one
database and <a class="reference internal" href="../introduction/groups.html#groups"><span class="std std-ref">groups</span></a> is much better. But if you have to:</p>
<ul class="simple">
<li>Create a second CamCOPS database (from the MySQL command line) as above.<ul>
<li><strong>Be careful:</strong> MySQL users are system-wide. So don’t think you can have a
user named <cite>camcopsmaster</cite> with password X for one database, and a user
named <cite>camcopsmaster</cite> with password Y for another database; attempting this
will merely change the password for that (single) user.</li>
</ul>
</li>
<li>Create a second CamCOPS configuration file, e.g. copying
<cite>/etc/camcops/camcops.conf</cite> to <cite>/etc/camcops/camcops2.conf</cite> and editing it to
point to the new database.</li>
<li>Run <code class="docutils literal notranslate"><span class="pre">camcops</span></code> from the command line, pointing it to the new configuration
file, to create the tables and a superuser (as above).</li>
<li>Add a second instance to the Apache configuration file and restart Apache.</li>
</ul>
</div>
<div class="section" id="database-performance-tuning">
<h2>10.13. Database performance tuning<a class="headerlink" href="#database-performance-tuning" title="Permalink to this headline">¶</a></h2>
<p>Ignore this section unless you actually have performance problems.</p>
<div class="section" id="mysql-innodb-commit">
<h3>10.13.1. MySQL/InnoDB commit<a class="headerlink" href="#mysql-innodb-commit" title="Permalink to this headline">¶</a></h3>
<p>Network latency can be improved considerably by altering the MySQL/InnoDB
log-on-commit behaviour. This is governed by the
<cite>innodb_flush_log_at_trx_commit</cite> variable. The default is 1, which is the
safest; it is required for ACID compliance. However, setting it to 2 makes
database write operations much faster.</p>
<p>This can by done by editing the MySQL configuration file <a class="footnote-reference" href="#linuxflavours" id="id9">[1]</a> to
add this line:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[mysqld]</span>

<span class="na">innodb_flush_log_at_trx_commit</span> <span class="o">=</span> <span class="s">2</span>
</pre></div>
</div>
<p>after which you would need to restart MySQL <a class="footnote-reference" href="#linuxflavours" id="id10">[1]</a>. Alternatively
you can change it dynamically at the MySQL command line with:</p>
<div class="highlight-mysql notranslate"><div class="highlight"><pre><span></span><span class="kt">SET</span> <span class="n">GLOBAL</span> <span class="n">innodb_flush_log_at_trx_commit</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="c1"># Use SHOW VARIABLES; to show the current values.</span>
</pre></div>
</div>
<p>See also:</p>
<ul class="simple">
<li><a class="reference external" href="http://stackoverflow.com/questions/14121464/mysql-is-slow-with-innodb-during-insert-compared-to-myisam">http://stackoverflow.com/questions/14121464/mysql-is-slow-with-innodb-during-insert-compared-to-myisam</a></li>
<li><a class="reference external" href="http://dev.mysql.com/doc/refman/5.5/en/innodb-parameters.html">http://dev.mysql.com/doc/refman/5.5/en/innodb-parameters.html</a></li>
</ul>
</div>
</div>
<div class="section" id="cosmetics">
<h2>10.14. Cosmetics<a class="headerlink" href="#cosmetics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="your-institutional-logo">
<h3>10.14.1. Your institutional logo<a class="headerlink" href="#your-institutional-logo" title="Permalink to this headline">¶</a></h3>
<p>Your logos (see the <a class="reference internal" href="server_config_file.html#server-config-file"><span class="std std-ref">configuration file</span></a>) will be
scaled to 45% of the active page width. You may need to add blank space to the
left if they look funny. See picture below.</p>
<img alt="../_images/scaling_logos.png" src="../_images/scaling_logos.png" />
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="linuxflavours" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id6">2</a>, <a class="fn-backref" href="#id7">3</a>, <a class="fn-backref" href="#id9">4</a>, <a class="fn-backref" href="#id10">5</a>)</em> See <a class="reference internal" href="../misc/linux_flavours.html#linux-flavours"><span class="std std-ref">Linux flavours</span></a> for a reminder of some common
differences between Linux operating systems.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="lamp" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[2]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/LAMP_(software_bundle">http://en.wikipedia.org/wiki/LAMP_(software_bundle</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="snakeoil" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[3]</a></td><td>This is referred to as creating a “snake oil” certificate. See e.g.
<a class="reference external" href="https://en.wikipedia.org/wiki/Snake_oil_(cryptography">https://en.wikipedia.org/wiki/Snake_oil_(cryptography</a>);
<a class="reference external" href="http://www.akadia.com/services/ssh_test_certificate.html">http://www.akadia.com/services/ssh_test_certificate.html</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="pyramiddebugtoolbar" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[4]</a></td><td><a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid_debugtoolbar/">https://docs.pylonsproject.org/projects/pyramid_debugtoolbar/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="fork" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[5]</a></td><td><a class="reference external" href="https://en.wikipedia.org/wiki/Fork_(system_call">https://en.wikipedia.org/wiki/Fork_(system_call</a>)</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="selinux" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[6]</a></td><td>See <a class="reference external" href="http://wiki.apache.org/httpd/13PermissionDenied">http://wiki.apache.org/httpd/13PermissionDenied</a> and
<a class="reference external" href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Confined_Services/chap-Managing_Confined_Services-The_Apache_HTTP_Server.html">https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Confined_Services/chap-Managing_Confined_Services-The_Apache_HTTP_Server.html</a></td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/download.html">2. Downloading CamCOPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client/client_installation.html">3. Installing and configuring the client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client/client_using.html">4. Using the client</a></li>
<li class="toctree-l1"><a class="reference internal" href="server_front_end_general.html">5. Web site: general use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tasks/_tasks_by_category.html">6. Tasks in CamCOPS by category</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tasks/_tasks_all.html">7. All tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client/client_troubleshooting.html">8. Troubleshooting client problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="server_installation.html">9. Installing CamCOPS on the server</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">10. Configuring the server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">10.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-flow">10.2. Data flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-your-firewall">10.3. Configure your firewall</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-database">10.4. Create a database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-edit-a-camcops-config-file">10.5. Create/edit a CamCOPS config file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-the-database-structure">10.6. Create the database structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-superuser">10.7. Create a superuser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#start-camcops">10.8. Start CamCOPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#point-the-front-end-web-server-to-camcops">10.9. Point the front-end web server to CamCOPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#browse-to-the-web-site">10.10. Browse to the web site</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-backups">10.11. Configure backups</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-than-one-camcops-instance">10.12. More than one CamCOPS instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database-performance-tuning">10.13. Database performance tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cosmetics">10.14. Cosmetics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="server_config_file.html">11. The CamCOPS server configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="server_front_end_admin.html">12. Web site: admin functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="server_command_line.html">13. CamCOPS command-line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="server_troubleshooting.html">14. Troubleshooting server problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licences/licences.html">15. Licences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">16. Developer notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/tcpip_ports.html">17. Common relevant TCP/IP ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/linux_flavours.html">18. Linux flavours</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autodoc/_index.html">19. Automatic documentation of core server source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">20. Change log/history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq_known_problems.html">21. FAQ and known problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../to_do.html">22. Things to do</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wishlist.html">23. Wishlist and blue-sky thoughts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/local_info.html">24. Local configuration information</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="server_installation.html"
                        title="previous chapter">9. Installing CamCOPS on the server</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="server_config_file.html"
                        title="next chapter">11. The CamCOPS server configuration file</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/server/server_configuration.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="server_config_file.html" title="11. The CamCOPS server configuration file"
             >next</a> |</li>
        <li class="right" >
          <a href="server_installation.html" title="9. Installing CamCOPS on the server"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CamCOPS 2.2.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2018, Rudolf Cardinal.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>