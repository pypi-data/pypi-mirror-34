
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>19.1.56. camcops_server.cc_modules.client_api &#8212; CamCOPS 2.2.4 documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/camcops_docs.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="19.1.57. camcops_server.cc_modules.merge_db" href="merge_db.html" />
    <link rel="prev" title="19.1.55. camcops_server.cc_modules.cc_xml" href="cc_xml.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="merge_db.html" title="19.1.57. camcops_server.cc_modules.merge_db"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cc_xml.html" title="19.1.55. camcops_server.cc_modules.cc_xml"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">CamCOPS 2.2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../_index.html" >19. Automatic documentation of core server source code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="_index.html" accesskey="U">&lt;no title&gt;</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-camcops_server.cc_modules.client_api">
<span id="camcops-server-cc-modules-client-api"></span><h1>19.1.56. camcops_server.cc_modules.client_api<a class="headerlink" href="#module-camcops_server.cc_modules.client_api" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<blockquote>
<div><p>Copyright (C) 2012-2018 Rudolf Cardinal (<a class="reference external" href="mailto:rudolf&#37;&#52;&#48;pobox&#46;com">rudolf<span>&#64;</span>pobox<span>&#46;</span>com</a>).</p>
<p>This file is part of CamCOPS.</p>
<p>CamCOPS is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>CamCOPS is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with CamCOPS. If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
</div></blockquote>
<hr class="docutils" />
<p>We use primarily SQLAlchemy Core here (in contrast to the ORM used elsewhere).</p>
<dl class="class">
<dt id="camcops_server.cc_modules.client_api.ClientApiTests">
<em class="property">class </em><code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">ClientApiTests</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#ClientApiTests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.ClientApiTests" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.audit">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">audit</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>details: str</em>, <em>patient_server_pk: int = None</em>, <em>tablename: str = None</em>, <em>server_pk: int = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#audit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.audit" title="Permalink to this definition">¶</a></dt>
<dd><p>Audit something.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.check_device_registered">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">check_device_registered</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#check_device_registered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.check_device_registered" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that a device is registered, or raise UserErrorException.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.check_upload_user_and_device">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">check_upload_user_and_device</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#check_upload_user_and_device"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.check_upload_user_and_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Stub function for the operation to check that a user is valid.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.clear_dirty_tables">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">clear_dirty_tables</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#clear_dirty_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.clear_dirty_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the dirty-table list for a device.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.client_api">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">client_api</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; pyramid.response.Response<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#client_api"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.client_api" title="Permalink to this definition">¶</a></dt>
<dd><p>View for client API. All tablet interaction comes through here.
Wraps main_client_api().</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.client_pks_that_exist">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">client_pks_that_exist</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest, table: sqlalchemy.sql.schema.Table, clientpk_name: str, clientpk_values: List[int]</em><span class="sig-paren">)</span> &#x2192; Dict[int, int]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#client_pks_that_exist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.client_pks_that_exist" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches for client PK values (for this device, current, and ‘now’)
matching the input list. Returns a dictionary of {clientpk: serverpk}
values for those that do.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.commit_all">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">commit_all</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>batchtime: pendulum.datetime.DateTime</em>, <em>preserving: bool</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#commit_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.commit_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Commits additions, removals, and preservations for all tables.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.commit_table">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">commit_table</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>batchtime: pendulum.datetime.DateTime</em>, <em>preserving: bool</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>clear_dirty: bool = True</em><span class="sig-paren">)</span> &#x2192; Tuple[int, int, int]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#commit_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.commit_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Commits additions, removals, and preservations for one table.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.delete_where_key_not">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">delete_where_key_not</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#delete_where_key_not"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.delete_where_key_not" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks records for deletion, for a device/table, where the client PK
is not in a specified list.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.duplicate_record">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">duplicate_record</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>serverpk: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#duplicate_record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.duplicate_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Duplicates the record defined by the table/serverpk combination.
Will raise an exception if the insert fails. Otherwise…
The old record then NEEDS MODIFICATION by flag_modified().
The new record NEEDS MODIFICATION by update_new_copy_of_record().</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.end_device_upload_batch">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">end_device_upload_batch</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>batchtime: pendulum.datetime.DateTime</em>, <em>preserving: bool</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#end_device_upload_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.end_device_upload_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Ends an upload batch, committing all changes made thus far.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.end_upload">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">end_upload</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#end_upload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.end_upload" title="Permalink to this definition">¶</a></dt>
<dd><p>Ends an upload and commits changes.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.ensure_valid_field_name">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">ensure_valid_field_name</code><span class="sig-paren">(</span><em>table: sqlalchemy.sql.schema.Table</em>, <em>fieldname: str</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#ensure_valid_field_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.ensure_valid_field_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures a field name contains only valid characters, and isn’t a
reserved fieldname that the user isn’t allowed to access.
Raises UserErrorException upon failure.</p>
<p>… 2017-10-08: shortcut: it’s OK if it’s a column name for a particular
table.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.ensure_valid_table_name">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">ensure_valid_table_name</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>tablename: str</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#ensure_valid_table_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.ensure_valid_table_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures a table name doesn’t contain bad characters, isn’t a reserved
table that the user is prohibited from accessing, and is a valid table name
that’s in the database. Raises UserErrorException upon failure.</p>
<p>… 2017-10-08: shortcut to all that: it’s OK if it’s listed as a valid
client table.
… 2018-01-16 (v2.2.0): check also that client version is OK</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.flag_all_records_deleted">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">flag_all_records_deleted</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#flag_all_records_deleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.flag_all_records_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks all records in a table as deleted (that are current and in the
current era).</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.flag_deleted">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">flag_deleted</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest, table: sqlalchemy.sql.schema.Table, pklist: Iterable[int]</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#flag_deleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.flag_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks record(s) as deleted, specified by a list of server PKs.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.flag_deleted_where_clientpk_not">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">flag_deleted_where_clientpk_not</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest, table: sqlalchemy.sql.schema.Table, clientpk_name: str, clientpk_values: Sequence[Any]</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#flag_deleted_where_clientpk_not"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.flag_deleted_where_clientpk_not" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks for deletion all current/current-era records for a device, defined
by a list of client-side PK values.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.flag_modified">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">flag_modified</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>pk: int</em>, <em>successor_pk: int</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#flag_modified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.flag_modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a record as old, storing its successor’s details.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.flag_record_for_preservation">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">flag_record_for_preservation</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>pk: int</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#flag_record_for_preservation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.flag_record_for_preservation" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a record for preservation (moving off the tablet, changing its
era details).</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_allowed_tables">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_allowed_tables</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; Dict[str, str]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_allowed_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_allowed_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the names of all possible tables on the server, each paired with
the minimum client (tablet) version that will be accepted for each table.
(Typically these are all the same as the minimum global tablet version.)</p>
<p>Uses the SELECT-like syntax.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_batch_details_start_if_needed">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_batch_details_start_if_needed</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; Tuple[Union[pendulum.datetime.DateTime, NoneType], Union[bool, NoneType]]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_batch_details_start_if_needed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_batch_details_start_if_needed" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a (upload_batch_utc, currently_preserving) tuple.</p>
<p>upload_batch_utc: the batchtime; UTC date/time of the current upload batch.
currently_preserving: Boolean; whether preservation (shifting to an older
era) is currently taking place.</p>
<p>SIDE EFFECT: if the username is different from the username that started
a previous upload batch for this device, we restart the upload batch (thus
rolling back previous pending changes).</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_dirty_tables">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_dirty_tables</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; List[sqlalchemy.sql.schema.Table]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_dirty_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_dirty_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns tables marked as dirty for this device.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_extra_strings">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_extra_strings</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; Dict[str, str]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_extra_strings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_extra_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch all local extra strings from the server.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_fields_and_values">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_fields_and_values</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>fields_var: str</em>, <em>values_var: str</em>, <em>mandatory: bool = True</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_fields_and_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_fields_and_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets fieldnames and matching values from two variables in a request.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_fields_from_post_var">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_fields_from_post_var</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>var: str</em>, <em>mandatory: bool = True</em><span class="sig-paren">)</span> &#x2192; List[str]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_fields_from_post_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_fields_from_post_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a comma-separated list of field names from a request and checks that
all are acceptable. Returns a list of fieldnames.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_id_info">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_id_info</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; Dict<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_id_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_id_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch server ID information.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_select_reply">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_select_reply</code><span class="sig-paren">(</span><em>fields: Sequence[str], rows: Sequence[Sequence[Any]]</em><span class="sig-paren">)</span> &#x2192; Dict[str, str]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_select_reply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_select_reply" title="Permalink to this definition">¶</a></dt>
<dd><p>Return format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nfields:X
fields:X
nrecords:X
record0:VALUES_AS_CSV_LIST_OF_ENCODED_SQL_VALUES
    ...
record{n}:VALUES_AS_CSV_LIST_OF_ENCODED_SQL_VALUES
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_server_id_info">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_server_id_info</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; Dict[str, str]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_server_id_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_server_id_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a reply for the tablet giving details of the server.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_server_pks_of_active_records">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_server_pks_of_active_records</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em><span class="sig-paren">)</span> &#x2192; List[int]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_server_pks_of_active_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_server_pks_of_active_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets server PKs of active records (_current and in the ‘NOW’ era) for
the specified device/table.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_server_pks_of_specified_records">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_server_pks_of_specified_records</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>wheredict: Dict</em><span class="sig-paren">)</span> &#x2192; List[int]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_server_pks_of_specified_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_server_pks_of_specified_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves server PKs for a table, for a given device, given a set of
‘where’ conditions specified in wheredict (as field/value combinations,
joined with AND).</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_single_field_from_post_var">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_single_field_from_post_var</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>var: str</em>, <em>mandatory: bool = True</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_single_field_from_post_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_single_field_from_post_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a field name from a the request and checks it’s not a bad
fieldname.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_str_var">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_str_var</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>var: str</em>, <em>mandatory: bool = True</em><span class="sig-paren">)</span> &#x2192; Union[str, NoneType]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_str_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_str_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a string variable from CamcopsRequest, raising an error that gets
passed to the client device if it’s mandatory and missing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> – CamcopsRequest</li>
<li><strong>var</strong> – name of variable to retrieve</li>
<li><strong>mandatory</strong> – if True, script aborts if variable missing</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">value</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_table_from_req">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_table_from_req</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>var: str</em><span class="sig-paren">)</span> &#x2192; sqlalchemy.sql.schema.Table<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_table_from_req"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_table_from_req" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a table name from a CGI form and checks it’s a valid client
table.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_tables_from_post_var">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_tables_from_post_var</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>var: str</em>, <em>mandatory: bool = True</em><span class="sig-paren">)</span> &#x2192; List[sqlalchemy.sql.schema.Table]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_tables_from_post_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_tables_from_post_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a list of tables from a CGI form variable, and ensures all are
valid.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.get_values_from_post_var">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">get_values_from_post_var</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>var: str</em>, <em>mandatory: bool = True</em><span class="sig-paren">)</span> &#x2192; List[Any]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#get_values_from_post_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.get_values_from_post_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a list of values from a CSV-separated list of SQL values
stored in a CGI form (including e.g. NULL, numbers, quoted strings, and
special handling for base-64/hex-encoded BLOBs.)</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.insert_record">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">insert_record</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest, table: sqlalchemy.sql.schema.Table, valuedict: Dict, predecessor_pk: Union[int, NoneType]</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#insert_record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.insert_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a record, or raises an exception if that fails.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.main_client_api">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">main_client_api</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; Dict[str, str]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#main_client_api"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.main_client_api" title="Permalink to this definition">¶</a></dt>
<dd><p>Main HTTP processor.</p>
<p>For success, returns a dictionary to send (will use status ‘200 OK’)
For failure, raises an exception.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.mark_table_dirty">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">mark_table_dirty</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#mark_table_dirty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.mark_table_dirty" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a table as having been modified during the current upload.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.record_exists">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">record_exists</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>clientpk_name: str</em>, <em>clientpk_value: Any</em><span class="sig-paren">)</span> &#x2192; Tuple[bool, Union[int, NoneType]]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#record_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.record_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a record exists, using the device’s perspective of a
table/client PK combination.
Returns (exists, serverpk), where exists is Boolean.
If exists is False, serverpk will be None.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.record_identical_by_date">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">record_identical_by_date</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>serverpk: int</em>, <em>client_date_value: pendulum.datetime.DateTime</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#record_identical_by_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.record_identical_by_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut to detecting a record being identical. Returns true if the
record (defined by its table/server PK) has a CLIENT_DATE_FIELD field
that matches that of the incoming record. As long as the tablet always
updates the CLIENT_DATE_FIELD when it saves a record, and the clock on the
device doesn’t go backwards by a certain exact millisecond-precision value,
this is a valid method.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.record_identical_full">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">record_identical_full</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>serverpk: int</em>, <em>wheredict: Dict</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#record_identical_full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.record_identical_full" title="Permalink to this definition">¶</a></dt>
<dd><p>If a record with the specified server PK exists in the specified table
having all its values matching the field/value combinations in wheredict
(joined with AND), returns True. Otherwise, returns False.
Used to detect if an incoming record matches the database record.</p>
<p>CURRENTLY UNUSED.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.register">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">register</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#register"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a device with the server.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.rollback_all">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">rollback_all</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#rollback_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.rollback_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Rolls back all pending changes for a device.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.rollback_table">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">rollback_table</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#rollback_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.rollback_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Rolls back changes for an individual table for a device.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.start_device_upload_batch">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">start_device_upload_batch</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#start_device_upload_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.start_device_upload_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts an upload batch for a device.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.start_preservation">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">start_preservation</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#start_preservation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.start_preservation" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks this upload batch as one in which all records will be preserved
(i.e. moved from NOW-era to an older era, so they can be deleted safely
from the tablet).</p>
<p>Without this, individual records can still be marked for preservation if
their MOVE_OFF_TABLET_FIELD field (_move_off_tablet) is set; see
upload_record and its functions.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.start_preserving">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">start_preserving</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#start_preserving"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.start_preserving" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts preservation (the process of moving records from the NOW era to
an older era, so they can be removed safely from the tablet).</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.start_upload">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">start_upload</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#start_upload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.start_upload" title="Permalink to this definition">¶</a></dt>
<dd><p>Begin an upload.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.update_new_copy_of_record">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">update_new_copy_of_record</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>serverpk: int</em>, <em>valuedict: Dict</em>, <em>predecessor_pk: int</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#update_new_copy_of_record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.update_new_copy_of_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Following duplicate_record(), use this to modify the new copy (defined
by the table/serverpk combination).</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.upload_empty_tables">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">upload_empty_tables</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#upload_empty_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.upload_empty_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>The tablet supplies a list of tables that are empty at its end, and we
will ‘wipe’ all appropriate tables; this reduces the number of HTTP
requests.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.upload_record">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">upload_record</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#upload_record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.upload_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload an individual record. (Typically used for BLOBs.)
Incoming POST information includes a CSV list of fields and a CSV list of
values.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.upload_record_core">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">upload_record_core</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em>, <em>table: sqlalchemy.sql.schema.Table</em>, <em>clientpk_name: str</em>, <em>valuedict: Dict</em>, <em>recordnum: int</em><span class="sig-paren">)</span> &#x2192; Tuple[Union[int, NoneType], int]<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#upload_record_core"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.upload_record_core" title="Permalink to this definition">¶</a></dt>
<dd><p>Uploads a record. Deals with IDENTICAL, NEW, and MODIFIED records.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.upload_table">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">upload_table</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#upload_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.upload_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload a table.</p>
<p>Incoming information in the POST request includes a CSV list of fields, a
count of the number of records being provided, and a set of variables named
record0 … record{nrecords}, each containing a CSV list of SQL-encoded
values.</p>
<p>Typically used for smaller tables, i.e. most except for BLOBs.</p>
</dd></dl>

<dl class="function">
<dt id="camcops_server.cc_modules.client_api.which_keys_to_send">
<code class="descclassname">camcops_server.cc_modules.client_api.</code><code class="descname">which_keys_to_send</code><span class="sig-paren">(</span><em>req: camcops_server.cc_modules.cc_request.CamcopsRequest</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../../_modules/camcops_server/cc_modules/client_api.html#which_keys_to_send"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#camcops_server.cc_modules.client_api.which_keys_to_send" title="Permalink to this definition">¶</a></dt>
<dd><p>Intended use: “For my device, and a specified table, here are my client-
side PKs (as a CSV list), and the modification dates for each corresponding
record (as a CSV list). Please tell me which records have mismatching dates
on the server, i.e. those that I need to re-upload.”</p>
<p>Used particularly for BLOBs, to reduce traffic, i.e. so we don’t have to
send a lot of BLOBs.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/download.html">2. Downloading CamCOPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client/client_installation.html">3. Installing and configuring the client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client/client_using.html">4. Using the client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server/server_front_end_general.html">5. Web site: general use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tasks/_tasks_by_category.html">6. Tasks in CamCOPS by category</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tasks/_tasks_all.html">7. All tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client/client_troubleshooting.html">8. Troubleshooting client problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server/server_installation.html">9. Installing CamCOPS on the server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server/server_configuration.html">10. Configuring the server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server/server_config_file.html">11. The CamCOPS server configuration file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server/server_front_end_admin.html">12. Web site: admin functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server/server_command_line.html">13. CamCOPS command-line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../server/server_troubleshooting.html">14. Troubleshooting server problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../licences/licences.html">15. Licences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">16. Developer notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/tcpip_ports.html">17. Common relevant TCP/IP ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/linux_flavours.html">18. Linux flavours</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../_index.html">19. Automatic documentation of core server source code</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../_index.html#server">19.1. Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">20. Change log/history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq_known_problems.html">21. FAQ and known problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../to_do.html">22. Things to do</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wishlist.html">23. Wishlist and blue-sky thoughts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/local_info.html">24. Local configuration information</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cc_xml.html"
                        title="previous chapter">19.1.55. camcops_server.cc_modules.cc_xml</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="merge_db.html"
                        title="next chapter">19.1.57. camcops_server.cc_modules.merge_db</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/autodoc/cc_modules/client_api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="merge_db.html" title="19.1.57. camcops_server.cc_modules.merge_db"
             >next</a> |</li>
        <li class="right" >
          <a href="cc_xml.html" title="19.1.55. camcops_server.cc_modules.cc_xml"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">CamCOPS 2.2.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../_index.html" >19. Automatic documentation of core server source code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="_index.html" >&lt;no title&gt;</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2018, Rudolf Cardinal.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>