{% load static %}
{% load materialize_nav %}
<!DOCTYPE html>
<html>
<head>
    {% block head %}{% endblock %}

    {% include_materialize_header %}

    {% block form_media %}{% endblock form_media %}

    {# <!--Let browser know website is optimized for mobile--> #}
    {#  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  #}
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="msqpplication-tap-highlight" content="no">
    <meta name="description" content="Application">

    <title>{% block header_title %}{% if PageTitle %}{% if AppName %}{{ AppName }} : {% endif %}{{ PageTitle }}{% elif Title %}{{ Title }}{% else %}{{ DefaultTitle }}{% endif %}{% endblock header_title %}</title>
</head>

<body>

    {% render_nav %}

    <main {% if ShowSidebar and FixedSidebar %}class="show_fixed_sidebar"{% endif %}>
        {% block main %}
        <div class="row">
            <div id='main_content' class="{% if not ContainerOn %}no-{% endif %}container" style="margin-top: 1rem">
                {% block content %}
                        <div class="col s12{% if SidePanel %} m9 l9 xl10{% endif %}">
                        {% block container %}
                                <div class="card">
                                <div class="card-content">
                                    {% block card %} {% endblock card %}
                                </div>
                            </div>
                        {% endblock container %}
                        </div>
                {% endblock content %}
            </div>
            {% if SidePanel %}
            <div id='right_side_panel' class="hide-on-small-only col s12 m3 l3 xl2" style="margin-left: 0">
                {% block side_panel %}
                    <div class="card" style="margin-left: 0;">
                        <div class="card-content" style="padding-left: 16px; padding-right: 16px;">
                            {% block side_card %}{% endblock side_card %}
                        </div>
                    </div>
                {% endblock side_panel %}
            </div>
            <div id='right_side_panel_mobil_actions' class='fixed-action-btn .no-autoinit show-on-small-only'>
                <a class="btn-floating btn-large">
                  <i class="large material-icons">more_vert</i> <!-- layers more_vert more_horiz -->
                </a>
                <ul>
                {% block side_panel_action %}
                    <li><a class='btn-floating waves-effect waves-light' onclick="toggle_side_panel()"><i class="material-icons">flip</i></a></li>
                {% endblock side_panel_action %}
                </ul>
            </div>
            {% endif %}
        </div>
        {% endblock main %}
    </main>

    <!--
        hidden footer to help with some floating objects
        materializecss issue with tooltips showing up in weird places when a floating button was the last item.
    -->
    <footer class="page-footer white {% if ShowSidebar and FixedSidebar %}show_fixed_sidebar{% endif %}">|</footer>


    {% block modals %}{% endblock modals %}

    <script type="text/javascript">
        function check_size_for_container(){
            if ($('.hide-on-small-only').css('display') == 'none'){
                $('.container').toggleClass('container had-container');
                $('.card.hoverable').toggleClass('hoverable had-hoverable');
                $('.card').toggleClass('card had-card');
                $('#right_side_panel_mobil_actions').css('display', 'block');
            } else {
                $('.had-container').toggleClass('had-container container');
                $('.had-card.had-hoverable').toggleClass('had-hoverable hoverable');
                $('.had-card').toggleClass('had-card card');
                $('#right_side_panel_mobil_actions').css('display', 'none');
            }
        }

        function toggle_side_panel(){
            if ($('#main_content').css('display') == 'none'){
                // Show main content
                $('#main_content').animate({'opacity': 1}, 300, function(){
                    $('#main_content').css('display', 'block');
                    $('#right_side_panel')
                        .css('display', '')
                        .css('padding', '')
                        .toggleClass('hide-on-small-only had-hide-on-small-only');
                });
            } else {
                // hide main content
                $('#main_content').animate({'opacity': 0}, 300, function(){
                    $('#main_content').css('display', 'none');
                    $('#right_side_panel')
                        .css('display', 'block')
                        .css('padding', '1rem')
                        .toggleClass('hide-on-small-only had-hide-on-small-only');
                });
            }
        }

        // Setup containers and cards for small screens
        check_size_for_container();

        $(window).on('load', function(){
            {% block js_document_ready %}{% endblock %}

            // Auto initialize all materialize css items
            try {
                M.AutoInit();
            } catch (e) {
            }

            // action button
            var elem = document.querySelector('.fixed-action-btn');
            var instance = M.FloatingActionButton.init(elem, {
              hoverEnabled: false
            });


            // Activate page notification
            {% if notification %}
                M.toast({
                    "html": "{{ notification }}",
                    "classes": "{{ notification_classes }}",
                    {% if notification_time %}'displayLength': {{ notification_time }},{% endif %}
                });
            {% endif %}
        });

        // Resize event for containers and cards on small screens
        window.addEventListener('resize', check_size_for_container, true)
    </script>

    {% block start_js_script %}{% endblock %}
</body>
</html>

