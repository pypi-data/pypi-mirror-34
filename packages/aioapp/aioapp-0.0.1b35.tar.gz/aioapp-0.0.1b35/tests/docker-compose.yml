version: '2'
services:
  postgres:
    image: postgres
    ports:
     - "127.0.0.1:19801:5432"
  redis:
    image: redis
    ports:
       - "127.0.0.1:19802:6379"
  rabbitmq:
    image: rabbitmq
    ports:
     - "127.0.0.1:19803:5672"

  tracer:
    image: jaegertracing/all-in-one
    ports:
      - "127.0.0.1:19806:9411"
      - "127.0.0.1:19807:16686"
    environment:
      - COLLECTOR_ZIPKIN_HTTP_PORT=9411
    logging:
      driver: none
  influxdb:
    # http://influxdb:8086/
    image: influxdb:latest
    container_name: influxdb
    environment:
      - INFLUXDB_DATA_ENGINE=tsm1
      - INFLUXDB_REPORTING_DISABLED=false
    volumes:
      - /var/lib/influxdb
  telegraf:
    image: telegraf:latest
    container_name: telegraf
    links:
      - influxdb
    ports:
      - "127.0.0.1:19804:8094/udp"
    volumes:
      - ./docker/telegraf.conf:/etc/telegraf/telegraf.conf:ro
  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    ports:
      - "127.0.0.1:19805:3000"
    environment:
      - GF_INSTALL_PLUGINS=grafana-clock-panel,briangann-gauge-panel,natel-plotly-panel,grafana-simple-json-datasource
    links:
      - influxdb
